/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

// This product includes color specifications and designs developed by Cynthia Brewer (http://colorbrewer.org/).
// JavaScript specs as packaged in the D3 library (d3js.org). Please see license at http://colorbrewer.org/export/LICENSE.txt

//     Underscore.js 1.7.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

!function(e,t){var n=t();"undefined"!=typeof define&&define.amd&&define(n),e.Elegans=n}(this,function(){var e,t,n;return function(a){function r(e,t){return E.call(e,t)}function i(e,t){var n,a,r,i,o,c,s,f,d,u,h,l=t&&t.split("/"),p=y.map,b=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(l=l.slice(0,l.length-1),e=e.split("/"),o=e.length-1,y.nodeIdCompat&&x.test(e[o])&&(e[o]=e[o].replace(x,"")),e=l.concat(e),d=0;d<e.length;d+=1)if(h=e[d],"."===h)e.splice(d,1),d-=1;else if(".."===h){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((l||b)&&p){for(n=e.split("/"),d=n.length;d>0;d-=1){if(a=n.slice(0,d).join("/"),l)for(u=l.length;u>0;u-=1)if(r=p[l.slice(0,u).join("/")],r&&(r=r[a])){i=r,c=d;break}if(i)break;!s&&b&&b[a]&&(s=b[a],f=d)}!i&&s&&(i=s,c=f),i&&(n.splice(0,c,i),e=n.join("/"))}return e}function o(e,t){return function(){return l.apply(a,w.call(arguments,0).concat([e,t]))}}function c(e){return function(t){return i(t,e)}}function s(e){return function(t){g[e]=t}}function f(e){if(r(m,e)){var t=m[e];delete m[e],v[e]=!0,h.apply(a,t)}if(!r(g,e)&&!r(v,e))throw new Error("No "+e);return g[e]}function d(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return function(){return y&&y.config&&y.config[e]||{}}}var h,l,p,b,g={},m={},y={},v={},E=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;p=function(e,t){var n,a=d(e),r=a[0];return e=a[1],r&&(r=i(r,t),n=f(r)),r?e=n&&n.normalize?n.normalize(e,c(t)):i(e,t):(e=i(e,t),a=d(e),r=a[0],e=a[1],r&&(n=f(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},b={require:function(e){return o(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:u(e)}}},h=function(e,t,n,i){var c,d,u,h,l,y,E=[],w=typeof n;if(i=i||e,"undefined"===w||"function"===w){for(t=!t.length&&n.length?["require","exports","module"]:t,l=0;l<t.length;l+=1)if(h=p(t[l],i),d=h.f,"require"===d)E[l]=b.require(e);else if("exports"===d)E[l]=b.exports(e),y=!0;else if("module"===d)c=E[l]=b.module(e);else if(r(g,d)||r(m,d)||r(v,d))E[l]=f(d);else{if(!h.p)throw new Error(e+" missing "+d);h.p.load(h.n,o(i,!0),s(d),{}),E[l]=g[d]}u=n?n.apply(g[e],E):void 0,e&&(c&&c.exports!==a&&c.exports!==g[e]?g[e]=c.exports:u===a&&y||(g[e]=u))}else e&&(g[e]=n)},e=t=l=function(e,t,n,r,i){if("string"==typeof e)return b[e]?b[e](t):f(p(e,t).f);if(!e.splice){if(y=e,y.deps&&l(y.deps,y.callback),!t)return;t.splice?(e=t,t=n,n=null):e=a}return t=t||function(){},"function"==typeof n&&(n=r,r=i),r?h(a,e,t,n):setTimeout(function(){h(a,e,t,n)},4),l},l.config=function(e){return l(e)},e._defined=g,n=function(e,t,n){t.splice||(n=t,t=[]),r(g,e)||r(m,e)||(m[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../lib/almond/almond",function(){}),n("utils/TrackballControls",[],function(){var e=function(e,t){function n(e){u.enabled!==!1&&(window.removeEventListener("keydown",n),g=b,b===h.NONE&&(e.keyCode!==u.keys[h.ROTATE]||u.noRotate?e.keyCode!==u.keys[h.ZOOM]||u.noZoom?e.keyCode!==u.keys[h.PAN]||u.noPan||(b=h.PAN):b=h.ZOOM:b=h.ROTATE))}function a(){u.enabled!==!1&&(b=g,window.addEventListener("keydown",n,!1))}function r(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),b===h.NONE&&(b=e.button),b!==h.ROTATE||u.noRotate?b!==h.ZOOM||u.noZoom?b!==h.PAN||u.noPan||(T.copy(O(e.pageX,e.pageY)),_.copy(T)):(E.copy(O(e.pageX,e.pageY)),w.copy(E)):(y.copy(j(e.pageX,e.pageY)),v.copy(y)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",o,!1),u.dispatchEvent(M))}function i(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),b!==h.ROTATE||u.noRotate?b!==h.ZOOM||u.noZoom?b!==h.PAN||u.noPan||_.copy(O(e.pageX,e.pageY)):w.copy(O(e.pageX,e.pageY)):v.copy(j(e.pageX,e.pageY)))}function o(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),b=h.NONE,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",o),u.dispatchEvent(k))}function c(e){if(u.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),E.y+=.01*t,u.dispatchEvent(M),u.dispatchEvent(k)}}function s(e){if(u.enabled!==!1){switch(e.touches.length){case 1:b=h.TOUCH_ROTATE,y.copy(j(e.touches[0].pageX,e.touches[0].pageY)),v.copy(y);break;case 2:b=h.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;R=x=Math.sqrt(t*t+n*n);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;T.copy(O(a,r)),_.copy(T);break;default:b=h.NONE}u.dispatchEvent(M)}}function f(e){if(u.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:v.copy(j(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;R=Math.sqrt(t*t+n*n);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;_.copy(O(a,r));break;default:b=h.NONE}}function d(e){if(u.enabled!==!1){switch(e.touches.length){case 1:v.copy(j(e.touches[0].pageX,e.touches[0].pageY)),y.copy(v);break;case 2:x=R=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;_.copy(O(t,n)),T.copy(_)}b=h.NONE,u.dispatchEvent(k)}}var u=this,h={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var l=1e-6,p=new THREE.Vector3,b=h.NONE,g=h.NONE,m=new THREE.Vector3,y=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Vector2,w=new THREE.Vector2,x=0,R=0,T=new THREE.Vector2,_=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var H={type:"change"},M={type:"start"},k={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var O=function(){var e=new THREE.Vector2;return function(t,n){return e.set((t-u.screen.left)/u.screen.width,(n-u.screen.top)/u.screen.height),e}}(),j=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(a,r){n.set((a-.5*u.screen.width-u.screen.left)/(.5*u.screen.width),(.5*u.screen.height+u.screen.top-r)/(.5*u.screen.height),0);var i=n.length();return u.noRoll?n.z=i<Math.SQRT1_2?Math.sqrt(1-i*i):.5/i:i>1?n.normalize():n.z=Math.sqrt(1-i*i),m.copy(u.object.position).sub(u.target),e.copy(u.object.up).setLength(n.y),e.add(t.copy(u.object.up).cross(m).setLength(n.x)),e.add(m.setLength(n.z)),e}}();this.rotateCamera=function(){var e=new THREE.Vector3,t=new THREE.Quaternion;return function(){var n=Math.acos(y.dot(v)/y.length()/v.length());n&&(e.crossVectors(y,v).normalize(),n*=u.rotateSpeed,t.setFromAxisAngle(e,-n),m.applyQuaternion(t),u.object.up.applyQuaternion(t),v.applyQuaternion(t),u.staticMoving?y.copy(v):(t.setFromAxisAngle(e,n*(u.dynamicDampingFactor-1)),y.applyQuaternion(t)))}}(),this.zoomCamera=function(){if(b===h.TOUCH_ZOOM_PAN){var e=x/R;x=R,m.multiplyScalar(e)}else{var e=1+(w.y-E.y)*u.zoomSpeed;1!==e&&e>0&&(m.multiplyScalar(e),u.staticMoving?E.copy(w):E.y+=(w.y-E.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var e=new THREE.Vector2,t=new THREE.Vector3,n=new THREE.Vector3;return function(){e.copy(_).sub(T),e.lengthSq()&&(e.multiplyScalar(m.length()*u.panSpeed),n.copy(m).cross(u.object.up).setLength(e.x),n.add(t.copy(u.object.up).setLength(e.y)),u.object.position.add(n),u.target.add(n),u.staticMoving?T.copy(_):T.add(e.subVectors(_,T).multiplyScalar(u.dynamicDampingFactor)))}}(),this.checkDistances=function(){u.noZoom&&u.noPan||(m.lengthSq()>u.maxDistance*u.maxDistance&&u.object.position.addVectors(u.target,m.setLength(u.maxDistance)),m.lengthSq()<u.minDistance*u.minDistance&&u.object.position.addVectors(u.target,m.setLength(u.minDistance)))},this.update=function(){m.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||u.zoomCamera(),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,m),u.checkDistances(),u.object.lookAt(u.target),p.distanceToSquared(u.object.position)>l&&(u.dispatchEvent(H),p.copy(u.object.position))},this.reset=function(){b=h.NONE,g=h.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),m.subVectors(u.object.position,u.target),u.object.lookAt(u.target),u.dispatchEvent(H),p.copy(u.object.position)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",c,!1),this.domElement.addEventListener("DOMMouseScroll",c,!1),this.domElement.addEventListener("touchstart",s,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",f,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",a,!1),this.handleResize(),this.update()};return e.prototype=Object.create(THREE.EventDispatcher.prototype),e.prototype.constructor=e,e}),n("utils/OrthographicTrackballControls",[],function(){var e=function(e,t){function n(e){u.enabled!==!1&&(window.removeEventListener("keydown",n),g=b,b===h.NONE&&(e.keyCode!==u.keys[h.ROTATE]||u.noRotate?e.keyCode!==u.keys[h.ZOOM]||u.noZoom?e.keyCode!==u.keys[h.PAN]||u.noPan||(b=h.PAN):b=h.ZOOM:b=h.ROTATE))}function a(){u.enabled!==!1&&(b=g,window.addEventListener("keydown",n,!1))}function r(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),b===h.NONE&&(b=e.button),b!==h.ROTATE||u.noRotate?b!==h.ZOOM||u.noZoom?b!==h.PAN||u.noPan||(_.copy(j(e.pageX,e.pageY)),H.copy(_)):(E.copy(j(e.pageX,e.pageY)),w.copy(E)):(y.copy(A(e.pageX,e.pageY)),v.copy(y)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",o,!1),u.dispatchEvent(k))}function i(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),b!==h.ROTATE||u.noRotate?b!==h.ZOOM||u.noZoom?b!==h.PAN||u.noPan||H.copy(j(e.pageX,e.pageY)):w.copy(j(e.pageX,e.pageY)):v.copy(A(e.pageX,e.pageY)))}function o(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),b=h.NONE,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",o),u.dispatchEvent(O))}function c(e){if(u.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),E.y+=.01*t,u.dispatchEvent(k),u.dispatchEvent(O)}}function s(e){if(u.enabled!==!1){switch(e.touches.length){case 1:b=h.TOUCH_ROTATE,y.copy(A(e.touches[0].pageX,e.touches[0].pageY)),v.copy(y);break;case 2:b=h.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;T=R=Math.sqrt(t*t+n*n);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;_.copy(j(a,r)),H.copy(_);break;default:b=h.NONE}u.dispatchEvent(k)}}function f(e){if(u.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:v.copy(A(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;T=Math.sqrt(t*t+n*n);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;H.copy(j(a,r));break;default:b=h.NONE}}function d(e){if(u.enabled!==!1){switch(e.touches.length){case 1:v.copy(A(e.touches[0].pageX,e.touches[0].pageY)),y.copy(v);break;case 2:R=T=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;H.copy(j(t,n)),_.copy(H)}b=h.NONE,u.dispatchEvent(O)}}var u=this,h={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new THREE.Vector3;var l=1e-6,p=new THREE.Vector3,b=h.NONE,g=h.NONE,m=new THREE.Vector3,y=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Vector2,w=new THREE.Vector2,x=1,R=0,T=0,_=new THREE.Vector2,H=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom,this.center0=new THREE.Vector2((this.left0+this.right0)/2,(this.top0+this.bottom0)/2);var M={type:"change"},k={type:"start"},O={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom,this.center0.set((this.left0+this.right0)/2,(this.top0+this.bottom0)/2)},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var j=function(){var e=new THREE.Vector2;return function(t,n){return e.set((t-u.screen.left)/u.screen.width,(n-u.screen.top)/u.screen.height),e}}(),A=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(a,r){n.set((a-.5*u.screen.width-u.screen.left)/(.5*u.screen.width),(.5*u.screen.height+u.screen.top-r)/(.5*u.screen.height),0);var i=n.length();return u.noRoll?n.z=i<Math.SQRT1_2?Math.sqrt(1-i*i):.5/i:i>1?n.normalize():n.z=Math.sqrt(1-i*i),m.copy(u.object.position).sub(u.target),e.copy(u.object.up).setLength(n.y),e.add(t.copy(u.object.up).cross(m).setLength(n.x)),e.add(m.setLength(n.z)),e}}();this.rotateCamera=function(){var e=new THREE.Vector3,t=new THREE.Quaternion;return function(){var n=Math.acos(y.dot(v)/y.length()/v.length());n&&(e.crossVectors(y,v).normalize(),n*=u.rotateSpeed,t.setFromAxisAngle(e,-n),m.applyQuaternion(t),u.object.up.applyQuaternion(t),v.applyQuaternion(t),u.staticMoving?y.copy(v):(t.setFromAxisAngle(e,n*(u.dynamicDampingFactor-1)),y.applyQuaternion(t)))}}(),this.zoomCamera=function(){var e;b===h.TOUCH_ZOOM_PAN?(e=R/T,R=T):e=1+(w.y-E.y)*u.zoomSpeed,1!==e&&e>0&&(x*=e,u.object.left=x*u.left0+(1-x)*u.center0.x,u.object.right=x*u.right0+(1-x)*u.center0.x,u.object.top=x*u.top0+(1-x)*u.center0.y,u.object.bottom=x*u.bottom0+(1-x)*u.center0.y,u.staticMoving?E.copy(w):E.y+=(w.y-E.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new THREE.Vector2,t=new THREE.Vector3,n=new THREE.Vector3;return function(){e.copy(H).sub(_),e.lengthSq()&&(e.multiplyScalar(m.length()*u.panSpeed),n.copy(m).cross(u.object.up).setLength(e.x),n.add(t.copy(u.object.up).setLength(e.y)),u.object.position.add(n),u.target.add(n),u.staticMoving?_.copy(H):_.add(e.subVectors(H,_).multiplyScalar(u.dynamicDampingFactor)))}}(),this.update=function(){m.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||(u.zoomCamera(),u.object.updateProjectionMatrix()),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,m),u.object.lookAt(u.target),p.distanceToSquared(u.object.position)>l&&(u.dispatchEvent(M),p.copy(u.object.position))},this.reset=function(){b=h.NONE,g=h.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),m.subVectors(u.object.position,u.target),u.object.left=u.left0,u.object.right=u.right0,u.object.top=u.top0,u.object.bottom=u.bottom0,u.object.lookAt(u.target),u.dispatchEvent(M),p.copy(u.object.position)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",c,!1),this.domElement.addEventListener("DOMMouseScroll",c,!1),this.domElement.addEventListener("touchstart",s,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",f,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",a,!1),this.handleResize(),this.update()};return e.prototype=Object.create(THREE.EventDispatcher.prototype),e.prototype.constructor=e,e}),n("components/world",["utils/TrackballControls","utils/OrthographicTrackballControls"],function(e,t){function n(n){this.options={width:0,height:0,perspective:!0},arguments.length>1&&Utils.merge(this.options,n),this.scene=new THREE.Scene,this.camera=n.perspective?new THREE.PerspectiveCamera(45,n.width/n.height,1,1e3):new THREE.OrthographicCamera(-20,20,-20,20),this.scene.add(this.camera);for(var a=[[1,1,1],[-1,-1,1],[-1,1,1],[1,-1,1]],r=0;4>r;r++){var i=new THREE.DirectionalLight(14540253);i.position.set(a[r][0],a[r][1],1*a[r][2]),this.scene.add(i)}return this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(n.width,n.height),this.renderer.setClearColor(n.bg_color,1),this.controls=n.perspective?new e(this.camera,this.renderer.domElement):new t(this.camera,this.renderer.domElement),this.controls.screen={left:0,top:0,width:n.width,height:n.height},this.controls.rotateSpeed=.5,this.camera.position.set(-30,31,42),this.camera.rotation.set(-.6,-.5,.6),window.camera=this.camera,this}return n.prototype.begin=function(e){e[0][0].appendChild(this.renderer.domElement);var t=this,n=1e3/30,a=Date.now();this.animate=function(){window.requestAnimationFrame(t.animate);var e=Date.now();e-a>n&&(a=e,t.renderer.render(t.scene,t.camera),t.controls.update())},this.animate()},n.prototype.addMesh=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.scene.add(e[t]);else this.scene.add(e)},n.prototype.removeMesh=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.scene.remove(e[t]);else this.scene.remove(e)},n}),n("utils/utils",[],function(){var e=function(e,t){t.call(e)},t=function(e,t){for(var n in t)e[n]=t[n];return e};return exports={mixin:e,merge:t}}),n("components/space",["utils/utils"],function(e){function t(t,n){this.options={axis_labels:{x:"X",y:"Y",z:"Z"},mode:"wireframe",grid:!0},arguments.length>1&&e.merge(this.options,n);var i=-10,o=10,c=o-i,s=new THREE.PlaneGeometry(c,c),f=new THREE.MeshBasicMaterial({color:15790320,shading:THREE.FlatShading,overdraw:.5,side:THREE.DoubleSide}),d=function(e,t,n){return new THREE.Vector3(e,t,n)};if(this.meshes=[],"solid"==this.options.mode){var u=new THREE.Mesh(s,f),h=new THREE.Mesh(s,f),l=new THREE.Mesh(s,f);h.rotateOnAxis(d(1,0,0),Math.PI/2),h.translateOnAxis(d(0,0,-1),-10),l.rotateOnAxis(d(0,1,0),Math.PI/2),l.translateOnAxis(d(0,0,-1),-10),u.translateOnAxis(d(0,0,1),-10),this.meshes.push(u),this.meshes.push(h),this.meshes.push(l)}else if("wireframe"==this.options.mode){this.meshes}this.scales={},this.scales.x=d3.scale.linear().domain([t.x.max,t.x.min]).range([-10,10]),this.scales.y=d3.scale.linear().domain([t.y.max,t.y.min]).range([10,-10]),this.scales.z=d3.scale.linear().domain([t.z.max,t.z.min]).range([10,-10]);var p=d3.scale.linear().domain([t.x.max,t.x.min]).range([20,0]),b=d3.scale.linear().domain([t.y.max,t.y.min]).range([20,0]),g=d3.scale.linear().domain([t.z.max,t.z.min]).range([20,0]);return this.meshes=this.meshes.concat(a(this.options.axis_labels.x,d(10,10,-10),d(-10,10,-10),d(0,1,0),p)),this.meshes=this.meshes.concat(a(this.options.axis_labels.y,d(-10,-10,-10),d(-10,10,-10),d(-1,0,0),b)),this.meshes=this.meshes.concat(a(this.options.axis_labels.z,d(10,10,-10),d(10,10,10),d(0,1,0),g)),this.options.grid&&(this.meshes.push(r([-10,10],[-10,10],[-10,-10],2)),this.meshes.push(r([-10,10],[-10,-10],[-10,10],2)),this.meshes.push(r([10,10],[-10,10],[-10,10],2))),this}var n=function(e,t){var n=document.createElement("canvas");n.width=100,n.height=100;var a=n.getContext("2d");a.fillStyle="rgb(0, 0, 0)",a.font="60px sans-serif";var r=a.measureText(e).width;a.fillText(e,(100-r)/2,80);var i=new THREE.Texture(n);i.flipY=!0,i.needsUpdate=!0;var o=new THREE.SpriteMaterial({map:i,transparent:!0,useScreenCoordinates:!1}),c=new THREE.Sprite(o);return c.scale.set(1.5,1.5),c.position.set.apply(c.position,t.toArray()),c},a=function(e,t,a,r,i){var o=[],c=new THREE.Geometry,s=(new THREE.Vector3).subVectors(a,t).normalize();c.vertices.push(t),c.vertices.push(a);var f=(new THREE.Vector3).addVectors(a,t).divideScalar(2);f.add(r.clone().multiplyScalar(3)),o.push(n(e,f));for(var d=d3.select("body").append("svg").style("width","500").style("height","500").style("display","none"),u=d.append("g").call(d3.svg.axis().scale(i).orient("left").ticks(5)).selectAll(".tick"),h=0;h<u[0].length;h++){var l=u[0][h].getAttribute("transform"),p=/translate\(((?:-|\d|.)+),((?:-|\d|.)+)\)/g.exec(l),b=(new THREE.Vector3).addVectors(t,s.clone().multiplyScalar(p[2])),g=(new THREE.Vector3).addVectors(b,r.clone().multiplyScalar(.3)),m=(new THREE.Vector3).addVectors(b,r.clone().multiplyScalar(-.3));c.vertices.push(g),c.vertices.push(m);var y=u[0][h].children[1].childNodes[0].nodeValue,v=(new THREE.Vector3).addVectors(b,r.clone().multiplyScalar(1)),E=n(y,v);o.push(E)}d.remove();var w=new THREE.LineBasicMaterial({color:0,opacity:.2}),x=new THREE.Line(c,w,THREE.LinePieces);return o.push(x),o},r=function(e,t,n,a){var r=new THREE.Geometry;if(e[0]!=e[1])for(var i=e[0];i<=e[1];i+=a)r.vertices.push(new THREE.Vector3(i,t[0],n[0])),r.vertices.push(new THREE.Vector3(i,t[1],n[1]));if(t[0]!=t[1])for(var o=t[0];o<=t[1];o+=a)r.vertices.push(new THREE.Vector3(e[0],o,n[0])),r.vertices.push(new THREE.Vector3(e[1],o,n[1]));if(n[0]!=n[1])for(var c=n[0];c<=n[1];c+=a)r.vertices.push(new THREE.Vector3(e[0],t[0],c)),r.vertices.push(new THREE.Vector3(e[1],t[1],c));var s=new THREE.LineBasicMaterial({color:13421772,opacity:.2}),f=new THREE.Line(r,s,THREE.LinePieces);return f};return t.prototype.getScales=function(){return this.scales},t.prototype.getMeshes=function(){return this.meshes},t}),n("utils/database",[],function(){var e={lists:{}};return e.add=function(e,t,n,a,r){var i={},o=[1/0,-1/0];t.forEach(function(e){var t=e[a];i[e[a]]=e[n],o[0]=t>o[0]?o[0]:t,o[1]=t<o[1]?o[1]:t}),this.lists[e]={data:i,seek:r},this.range=o},e.seek=function(e,t){for(var n in this.lists)this.lists[n].seek=t},e.getRange=function(){return this.range},e.find=function(e){var t=this.lists[e].seek;return this.lists[e].data[t]},e}),n("components/player",["utils/utils","utils/database"],function(e,t){function n(t,n,a){this.options={},arguments.length>1&&e.merge(this.options,a),this.model=t,this.stage=n}return n.prototype.render=function(){var e=t.getRange(),n=this.model.append("div").style("height",27).style("width",500).style("background-color","#fff"),a=this;n.append("button").attr("title","play").style("float","left").text("â–º").on("click",function(){console.log("huga"),a.start()});var r=n.append("form").style("height",30).style("width",500);r.append("input").attr("type","range").attr("name","range").attr("class","range").attr("max",e[1]).attr("min",e[0]).attr("step",1).attr("value",e[0]).style("width",350).style("float","left").on("change",function(){a.update(this.value)}),r.append("input").attr("type","text").style("width",30).style("float","left").attr("value",e[0]).attr("class","input_label"),r.append("div").style("color","#fff").append("p").style("line-height",25).text(e[1]),this.form=r},n.prototype.start=function(){var e=this,t=window.setInterval("timer_func()",400);window.timer_func=function(){var n,a,r;e.form.select(".range").each(function(){var e=d3.select(this);n=parseInt(this.value),a=parseInt(e.attr("step")),r=parseInt(e.attr("max"))}),r>=n+a?(console.log("called!"),e.form.select(".range").each(function(){this.value=n+a}),e.update(n+a)):window.clearInterval(t)}},n.prototype.update=function(e){t.seek("",e),this.model.select(".input_label").attr("value",e),this.stage.clear(),this.stage.update()},n}),n("utils/range",[],function(){function e(e,t){arguments.length>1?(this.max=e,this.min=t):(this.max=e[1],this.min=e[0])}return e.prototype.divide=function(e){for(var t=new Array,n=Math.ceil((this.max-this.min)/(e-1)),a=0;e>a;a++)t.push(this.min+n*a);return t},e.expand=function(t,n){return new e(Math.max(t.max,n.max),Math.min(t.min,n.min))},e}),n("components/stage",["components/world","components/space","components/player","utils/utils","utils/range"],function(e,t,n,a,r){function i(t,i){this.options={width:700,height:530,world_width:500,world_height:500,axis_labels:{x:"X",y:"Y",z:"Z"},bg_color:16777215,player:!1,space_mode:"wireframe",range:{x:[0,0],y:[0,0],z:[0,0]},autorange:!0,grid:!0,perspective:!0},arguments.length>1&&a.merge(this.options,i);var o=d3.select(t);if(o.style("width",String(this.options.width)),this.world_space=o.append("div").style("float","left").style("width",String(this.options.world_width)).style("height",String(this.options.world_height)),this.legend_space=o.append("div").style("float","left").style("width",String(this.options.width-this.options.world_width)).style("height",String(this.options.height)),this.options.player){var c=o.append("div").style("width",String(this.options.width)).style("height",String(this.options.height-this.options.world_height));this.player=new n(c,this)}return this.charts=[],this.world=new e({width:this.options.world_width,height:this.options.world_height,bg_color:this.options.bg_color,perspective:this.options.perspective}),this.data_ranges={x:new r(this.options.range.x[0],this.options.range.x[1]),y:new r(this.options.range.y[0],this.options.range.y[1]),z:new r(this.options.range.z[0],this.options.range.z[1])},this}return i.prototype.add=function(e){if(this.options.autorange){var t=e.getDataRanges(),n=this;["x","y","z"].forEach(function(e){n.data_ranges[e]=r.expand(n.data_ranges[e],t[e])})}this.charts.push(e)},i.prototype.render=function(){this.space=new t(this.data_ranges,{axis_labels:this.options.axis_labels,mode:this.options.space_mode,grid:this.options.grid}),this.world.addMesh(this.space.getMeshes());for(var e=0;e<this.charts.length;e++){var n=this.charts[e];if(n.generateMesh(this.space.getScales()),this.world.addMesh(n.getMesh()),n.hasLegend()){var a=n.getLegend();this.legend_space[0][0].appendChild(a[0][0])}}this.options.player&&this.player.render(),this.world.begin(this.world_space)},i.prototype.dispose=function(){this.clear(),this.world.renderer.clear()},i.prototype.clear=function(){for(var e=0;e<this.charts.length;e++){var t=this.charts[e];this.world.removeMesh(t.getMesh())}},i.prototype.update=function(){for(var e=0;e<this.charts.length;e++){var t=this.charts[e];t.generateMesh(this.space.getScales()),this.world.addMesh(t.getMesh())}},i}),n("components/legends",[],function(){function e(e,t){for(var n=d3.scale.linear().domain([e.max,e.min]).range([0,200]),a=d3.select(document.createElement("div")).style("padding","5px").style("float","left").style("width","100").style("height","auto"),r=a.append("svg").style("height","100%").style("width","100px"),i=r.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%"),o=0;o<t.length;o++)i.append("svg:stop").attr("offset",100/(t.length-1)*o+"%").attr("stop-color",t[o]);var c=r.append("g");return c.append("svg:rect").attr("y",10).attr("width","25").attr("height","200").style("fill","url(#gradient)"),r.append("g").attr("width","100").attr("height","200").attr("class","axis").attr("transform","translate(25,10)").call(d3.svg.axis().scale(n).orient("right").ticks(5)),r.selectAll(".axis").selectAll("path").style("fill","none").style("stroke","black").style("shape-rendering","crispEdges"),r.selectAll(".axis").selectAll("line").style("fill","none").style("stroke","black").style("shape-rendering","crispEdges"),r.selectAll(".axis").selectAll("text").style("font-family","san-serif").style("font-size","11px"),a}function t(e,t,n){var a=d3.select(document.createElement("div")).style("padding","4").style("height","16").style("width","100%"),r=a.append("svg").style("height","30px").style("width","100px"),i=function(e){var t=e.target;"0.0"==t.getAttribute("fill-opacity")?(t.setAttribute("fill-opacity","1.0"),t.chart.appear()):(t.setAttribute("fill-opacity","0.0"),t.chart.disappear())},o=r.append("circle").attr("cx","8").attr("cy","8").attr("r","6").attr("stroke",t).attr("stroke-width","2").attr("fill",t).style("cursor","pointer");return o[0][0].chart=n,o[0][0].onclick=i,r.append("text").attr("x","18").attr("y","12").attr("font-size","12").text(e),a}var n={generateContinuousLegend:e,generateDiscreteLegend:t};return n}),n("utils/datasets",["utils/range","utils/database"],function(e,t){function n(n){var a={};this.raw="string"==typeof n?t.find(n):n;for(var r in n)a[r]=new e(d3.max(this.raw[r],function(e){return Math.max.apply(null,e)}),d3.min(this.raw[r],function(e){return Math.min.apply(null,e)}));return this.ranges=a,this.raw=n,this}function a(n){this.ranges={},this.raw="string"==typeof n?t.find(n):n;for(var a in this.raw)this.ranges[a]=new e(d3.max(this.raw[a],function(e){return e}),d3.min(this.raw[a],function(e){return e}))}n.prototype.getRanges=function(){return this.ranges},a.prototype.getRanges=function(){return this.ranges};var r={Matrix:n,Array:a};return r}),n("utils/colorbrewer",[],function(){var e={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};
return e}),n("charts/surface",["components/legends","utils/utils","utils/datasets","utils/colorbrewer"],function(e,t,n,a){function r(e,r){this.options={fill_colors:a.Reds[3],has_legend:!0},arguments.length>1&&t.merge(this.options,r),this.dataset=new n.Matrix(e),this.ranges=this.dataset.getRanges()}return r.prototype.generateMesh=function(e){for(var t=this.dataset.raw,n=new THREE.Geometry,a=d3.scale.linear().domain(this.ranges.z.divide(this.options.fill_colors.length)).range(this.options.fill_colors),r=[],i=function(e,t){return e*c+t},o=function(e,t,n,a,r){var i=new THREE.Vector3,o=new THREE.Vector3;i.subVectors(e.vertices[t],e.vertices[n]),o.subVectors(e.vertices[t],e.vertices[a]),o.cross(i).normalize();var c=[r[t],r[n],r[a]];e.faces.push(new THREE.Face3(t,n,a,o,c)),c=[r[a],r[n],r[t]],e.faces.push(new THREE.Face3(a,n,t,o.negate(),c))},c=t.x.length,s=t.x[0].length,f=0;c>f;f++)for(var d=0;s>d;d++)n.vertices.push(new THREE.Vector3(e.x(t.x[f][d]),e.y(t.y[f][d]),e.z(t.z[f][d]))),r.push(new THREE.Color(a(t.z[f][d])));for(var u=0;c-1>u;u++)for(var h=0;s-1>h;h++)o(n,i(u,h),i(u+1,h),i(u,h+1),r),o(n,i(u+1,h),i(u+1,h+1),i(u,h+1),r);var l=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});this.mesh=new THREE.Mesh(n,l)},r.prototype.getDataRanges=function(){return this.ranges},r.prototype.hasLegend=function(){return this.options.has_legend},r.prototype.getLegend=function(){return e.generateContinuousLegend(this.ranges.z,this.options.fill_colors)},r.prototype.getMesh=function(){return this.mesh},r}),n("charts/wireframe",["components/legends","utils/utils","utils/datasets","utils/colorbrewer"],function(e,t,n){function a(e,a){this.options={name:"wireframe",color:"#999999",thickness:1,has_legend:!0},arguments.length>1&&t.merge(this.options,a),this.dataset=new n.Matrix(e),this.ranges=this.dataset.getRanges()}return a.prototype.generateMesh=function(e){for(var t=this.dataset.raw,n=t.x.length,a=t.x[0].length,r=new THREE.LineBasicMaterial({color:this.options.color,linewidth:this.options.thickness,transparent:!0}),i=[],o=0;n>o;o++){for(var c=new THREE.Geometry,s=0;a>s;s++)c.vertices.push(new THREE.Vector3(e.x(t.x[o][s]),e.y(t.y[o][s]),e.z(t.z[o][s])));i.push(new THREE.Line(c,r))}for(var s=0;a>s;s++){for(var c=new THREE.Geometry,o=0;n>o;o++)c.vertices.push(new THREE.Vector3(e.x(t.x[o][s]),e.y(t.y[o][s]),e.z(t.z[o][s])));i.push(new THREE.Line(c,r))}this.mesh=i},a.prototype.getDataRanges=function(){return this.ranges},a.prototype.hasLegend=function(){return this.options.has_legend},a.prototype.disappear=function(){for(var e=0;e<this.mesh.length;e++)this.mesh[e].material.opacity=0,this.mesh[e].material.needsUpdate=!0},a.prototype.appear=function(){for(var e=0;e<this.mesh.length;e++)this.mesh[e].material.opacity=1,this.mesh[e].material.needsUpdate=!0},a.prototype.getLegend=function(){return e.generateDiscreteLegend(this.options.name,this.options.color,this)},a.prototype.getMesh=function(){return this.mesh},a}),function(){var e=this,t=e._,a=Array.prototype,r=Object.prototype,i=Function.prototype,o=a.push,c=a.slice,s=a.concat,f=r.toString,d=r.hasOwnProperty,u=Array.isArray,h=Object.keys,l=i.bind,p=function(e){return e instanceof p?e:this instanceof p?void(this._wrapped=e):new p(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):e._=p,p.VERSION="1.7.0";var b=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,a){return e.call(t,n,a)};case 3:return function(n,a,r){return e.call(t,n,a,r)};case 4:return function(n,a,r,i){return e.call(t,n,a,r,i)}}return function(){return e.apply(t,arguments)}};p.iteratee=function(e,t,n){return null==e?p.identity:p.isFunction(e)?b(e,t,n):p.isObject(e)?p.matches(e):p.property(e)},p.each=p.forEach=function(e,t,n){if(null==e)return e;t=b(t,n);var a,r=e.length;if(r===+r)for(a=0;r>a;a++)t(e[a],a,e);else{var i=p.keys(e);for(a=0,r=i.length;r>a;a++)t(e[i[a]],i[a],e)}return e},p.map=p.collect=function(e,t,n){if(null==e)return[];t=p.iteratee(t,n);for(var a,r=e.length!==+e.length&&p.keys(e),i=(r||e).length,o=Array(i),c=0;i>c;c++)a=r?r[c]:c,o[c]=t(e[a],a,e);return o};var g="Reduce of empty array with no initial value";p.reduce=p.foldl=p.inject=function(e,t,n,a){null==e&&(e=[]),t=b(t,a,4);var r,i=e.length!==+e.length&&p.keys(e),o=(i||e).length,c=0;if(arguments.length<3){if(!o)throw new TypeError(g);n=e[i?i[c++]:c++]}for(;o>c;c++)r=i?i[c]:c,n=t(n,e[r],r,e);return n},p.reduceRight=p.foldr=function(e,t,n,a){null==e&&(e=[]),t=b(t,a,4);var r,i=e.length!==+e.length&&p.keys(e),o=(i||e).length;if(arguments.length<3){if(!o)throw new TypeError(g);n=e[i?i[--o]:--o]}for(;o--;)r=i?i[o]:o,n=t(n,e[r],r,e);return n},p.find=p.detect=function(e,t,n){var a;return t=p.iteratee(t,n),p.some(e,function(e,n,r){return t(e,n,r)?(a=e,!0):void 0}),a},p.filter=p.select=function(e,t,n){var a=[];return null==e?a:(t=p.iteratee(t,n),p.each(e,function(e,n,r){t(e,n,r)&&a.push(e)}),a)},p.reject=function(e,t,n){return p.filter(e,p.negate(p.iteratee(t)),n)},p.every=p.all=function(e,t,n){if(null==e)return!0;t=p.iteratee(t,n);var a,r,i=e.length!==+e.length&&p.keys(e),o=(i||e).length;for(a=0;o>a;a++)if(r=i?i[a]:a,!t(e[r],r,e))return!1;return!0},p.some=p.any=function(e,t,n){if(null==e)return!1;t=p.iteratee(t,n);var a,r,i=e.length!==+e.length&&p.keys(e),o=(i||e).length;for(a=0;o>a;a++)if(r=i?i[a]:a,t(e[r],r,e))return!0;return!1},p.contains=p.include=function(e,t){return null==e?!1:(e.length!==+e.length&&(e=p.values(e)),p.indexOf(e,t)>=0)},p.invoke=function(e,t){var n=c.call(arguments,2),a=p.isFunction(t);return p.map(e,function(e){return(a?t:e[t]).apply(e,n)})},p.pluck=function(e,t){return p.map(e,p.property(t))},p.where=function(e,t){return p.filter(e,p.matches(t))},p.findWhere=function(e,t){return p.find(e,p.matches(t))},p.max=function(e,t,n){var a,r,i=-1/0,o=-1/0;if(null==t&&null!=e){e=e.length===+e.length?e:p.values(e);for(var c=0,s=e.length;s>c;c++)a=e[c],a>i&&(i=a)}else t=p.iteratee(t,n),p.each(e,function(e,n,a){r=t(e,n,a),(r>o||r===-1/0&&i===-1/0)&&(i=e,o=r)});return i},p.min=function(e,t,n){var a,r,i=1/0,o=1/0;if(null==t&&null!=e){e=e.length===+e.length?e:p.values(e);for(var c=0,s=e.length;s>c;c++)a=e[c],i>a&&(i=a)}else t=p.iteratee(t,n),p.each(e,function(e,n,a){r=t(e,n,a),(o>r||1/0===r&&1/0===i)&&(i=e,o=r)});return i},p.shuffle=function(e){for(var t,n=e&&e.length===+e.length?e:p.values(e),a=n.length,r=Array(a),i=0;a>i;i++)t=p.random(0,i),t!==i&&(r[i]=r[t]),r[t]=n[i];return r},p.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=p.values(e)),e[p.random(e.length-1)]):p.shuffle(e).slice(0,Math.max(0,t))},p.sortBy=function(e,t,n){return t=p.iteratee(t,n),p.pluck(p.map(e,function(e,n,a){return{value:e,index:n,criteria:t(e,n,a)}}).sort(function(e,t){var n=e.criteria,a=t.criteria;if(n!==a){if(n>a||void 0===n)return 1;if(a>n||void 0===a)return-1}return e.index-t.index}),"value")};var m=function(e){return function(t,n,a){var r={};return n=p.iteratee(n,a),p.each(t,function(a,i){var o=n(a,i,t);e(r,a,o)}),r}};p.groupBy=m(function(e,t,n){p.has(e,n)?e[n].push(t):e[n]=[t]}),p.indexBy=m(function(e,t,n){e[n]=t}),p.countBy=m(function(e,t,n){p.has(e,n)?e[n]++:e[n]=1}),p.sortedIndex=function(e,t,n,a){n=p.iteratee(n,a,1);for(var r=n(t),i=0,o=e.length;o>i;){var c=i+o>>>1;n(e[c])<r?i=c+1:o=c}return i},p.toArray=function(e){return e?p.isArray(e)?c.call(e):e.length===+e.length?p.map(e,p.identity):p.values(e):[]},p.size=function(e){return null==e?0:e.length===+e.length?e.length:p.keys(e).length},p.partition=function(e,t,n){t=p.iteratee(t,n);var a=[],r=[];return p.each(e,function(e,n,i){(t(e,n,i)?a:r).push(e)}),[a,r]},p.first=p.head=p.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:c.call(e,0,t)},p.initial=function(e,t,n){return c.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},p.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:c.call(e,Math.max(e.length-t,0))},p.rest=p.tail=p.drop=function(e,t,n){return c.call(e,null==t||n?1:t)},p.compact=function(e){return p.filter(e,p.identity)};var y=function(e,t,n,a){if(t&&p.every(e,p.isArray))return s.apply(a,e);for(var r=0,i=e.length;i>r;r++){var c=e[r];p.isArray(c)||p.isArguments(c)?t?o.apply(a,c):y(c,t,n,a):n||a.push(c)}return a};p.flatten=function(e,t){return y(e,t,!1,[])},p.without=function(e){return p.difference(e,c.call(arguments,1))},p.uniq=p.unique=function(e,t,n,a){if(null==e)return[];p.isBoolean(t)||(a=n,n=t,t=!1),null!=n&&(n=p.iteratee(n,a));for(var r=[],i=[],o=0,c=e.length;c>o;o++){var s=e[o];if(t)o&&i===s||r.push(s),i=s;else if(n){var f=n(s,o,e);p.indexOf(i,f)<0&&(i.push(f),r.push(s))}else p.indexOf(r,s)<0&&r.push(s)}return r},p.union=function(){return p.uniq(y(arguments,!0,!0,[]))},p.intersection=function(e){if(null==e)return[];for(var t=[],n=arguments.length,a=0,r=e.length;r>a;a++){var i=e[a];if(!p.contains(t,i)){for(var o=1;n>o&&p.contains(arguments[o],i);o++);o===n&&t.push(i)}}return t},p.difference=function(e){var t=y(c.call(arguments,1),!0,!0,[]);return p.filter(e,function(e){return!p.contains(t,e)})},p.zip=function(e){if(null==e)return[];for(var t=p.max(arguments,"length").length,n=Array(t),a=0;t>a;a++)n[a]=p.pluck(arguments,a);return n},p.object=function(e,t){if(null==e)return{};for(var n={},a=0,r=e.length;r>a;a++)t?n[e[a]]=t[a]:n[e[a][0]]=e[a][1];return n},p.indexOf=function(e,t,n){if(null==e)return-1;var a=0,r=e.length;if(n){if("number"!=typeof n)return a=p.sortedIndex(e,t),e[a]===t?a:-1;a=0>n?Math.max(0,r+n):n}for(;r>a;a++)if(e[a]===t)return a;return-1},p.lastIndexOf=function(e,t,n){if(null==e)return-1;var a=e.length;for("number"==typeof n&&(a=0>n?a+n+1:Math.min(a,n+1));--a>=0;)if(e[a]===t)return a;return-1},p.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var a=Math.max(Math.ceil((t-e)/n),0),r=Array(a),i=0;a>i;i++,e+=n)r[i]=e;return r};var v=function(){};p.bind=function(e,t){var n,a;if(l&&e.bind===l)return l.apply(e,c.call(arguments,1));if(!p.isFunction(e))throw new TypeError("Bind must be called on a function");return n=c.call(arguments,2),a=function(){if(!(this instanceof a))return e.apply(t,n.concat(c.call(arguments)));v.prototype=e.prototype;var r=new v;v.prototype=null;var i=e.apply(r,n.concat(c.call(arguments)));return p.isObject(i)?i:r}},p.partial=function(e){var t=c.call(arguments,1);return function(){for(var n=0,a=t.slice(),r=0,i=a.length;i>r;r++)a[r]===p&&(a[r]=arguments[n++]);for(;n<arguments.length;)a.push(arguments[n++]);return e.apply(this,a)}},p.bindAll=function(e){var t,n,a=arguments.length;if(1>=a)throw new Error("bindAll must be passed function names");for(t=1;a>t;t++)n=arguments[t],e[n]=p.bind(e[n],e);return e},p.memoize=function(e,t){var n=function(a){var r=n.cache,i=t?t.apply(this,arguments):a;return p.has(r,i)||(r[i]=e.apply(this,arguments)),r[i]};return n.cache={},n},p.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},p.defer=function(e){return p.delay.apply(p,[e,1].concat(c.call(arguments,1)))},p.throttle=function(e,t,n){var a,r,i,o=null,c=0;n||(n={});var s=function(){c=n.leading===!1?0:p.now(),o=null,i=e.apply(a,r),o||(a=r=null)};return function(){var f=p.now();c||n.leading!==!1||(c=f);var d=t-(f-c);return a=this,r=arguments,0>=d||d>t?(clearTimeout(o),o=null,c=f,i=e.apply(a,r),o||(a=r=null)):o||n.trailing===!1||(o=setTimeout(s,d)),i}},p.debounce=function(e,t,n){var a,r,i,o,c,s=function(){var f=p.now()-o;t>f&&f>0?a=setTimeout(s,t-f):(a=null,n||(c=e.apply(i,r),a||(i=r=null)))};return function(){i=this,r=arguments,o=p.now();var f=n&&!a;return a||(a=setTimeout(s,t)),f&&(c=e.apply(i,r),i=r=null),c}},p.wrap=function(e,t){return p.partial(t,e)},p.negate=function(e){return function(){return!e.apply(this,arguments)}},p.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,a=e[t].apply(this,arguments);n--;)a=e[n].call(this,a);return a}},p.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},p.before=function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},p.once=p.partial(p.before,2),p.keys=function(e){if(!p.isObject(e))return[];if(h)return h(e);var t=[];for(var n in e)p.has(e,n)&&t.push(n);return t},p.values=function(e){for(var t=p.keys(e),n=t.length,a=Array(n),r=0;n>r;r++)a[r]=e[t[r]];return a},p.pairs=function(e){for(var t=p.keys(e),n=t.length,a=Array(n),r=0;n>r;r++)a[r]=[t[r],e[t[r]]];return a},p.invert=function(e){for(var t={},n=p.keys(e),a=0,r=n.length;r>a;a++)t[e[n[a]]]=n[a];return t},p.functions=p.methods=function(e){var t=[];for(var n in e)p.isFunction(e[n])&&t.push(n);return t.sort()},p.extend=function(e){if(!p.isObject(e))return e;for(var t,n,a=1,r=arguments.length;r>a;a++){t=arguments[a];for(n in t)d.call(t,n)&&(e[n]=t[n])}return e},p.pick=function(e,t,n){var a,r={};if(null==e)return r;if(p.isFunction(t)){t=b(t,n);for(a in e){var i=e[a];t(i,a,e)&&(r[a]=i)}}else{var o=s.apply([],c.call(arguments,1));e=new Object(e);for(var f=0,d=o.length;d>f;f++)a=o[f],a in e&&(r[a]=e[a])}return r},p.omit=function(e,t,n){if(p.isFunction(t))t=p.negate(t);else{var a=p.map(s.apply([],c.call(arguments,1)),String);t=function(e,t){return!p.contains(a,t)}}return p.pick(e,t,n)},p.defaults=function(e){if(!p.isObject(e))return e;for(var t=1,n=arguments.length;n>t;t++){var a=arguments[t];for(var r in a)void 0===e[r]&&(e[r]=a[r])}return e},p.clone=function(e){return p.isObject(e)?p.isArray(e)?e.slice():p.extend({},e):e},p.tap=function(e,t){return t(e),e};var E=function(e,t,n,a){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof p&&(e=e._wrapped),t instanceof p&&(t=t._wrapped);var r=f.call(e);if(r!==f.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}if("object"!=typeof e||"object"!=typeof t)return!1;for(var i=n.length;i--;)if(n[i]===e)return a[i]===t;var o=e.constructor,c=t.constructor;if(o!==c&&"constructor"in e&&"constructor"in t&&!(p.isFunction(o)&&o instanceof o&&p.isFunction(c)&&c instanceof c))return!1;n.push(e),a.push(t);var s,d;if("[object Array]"===r){if(s=e.length,d=s===t.length)for(;s--&&(d=E(e[s],t[s],n,a)););}else{var u,h=p.keys(e);if(s=h.length,d=p.keys(t).length===s)for(;s--&&(u=h[s],d=p.has(t,u)&&E(e[u],t[u],n,a)););}return n.pop(),a.pop(),d};p.isEqual=function(e,t){return E(e,t,[],[])},p.isEmpty=function(e){if(null==e)return!0;if(p.isArray(e)||p.isString(e)||p.isArguments(e))return 0===e.length;for(var t in e)if(p.has(e,t))return!1;return!0},p.isElement=function(e){return!(!e||1!==e.nodeType)},p.isArray=u||function(e){return"[object Array]"===f.call(e)},p.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},p.each(["Arguments","Function","String","Number","Date","RegExp"],function(e){p["is"+e]=function(t){return f.call(t)==="[object "+e+"]"}}),p.isArguments(arguments)||(p.isArguments=function(e){return p.has(e,"callee")}),"function"!=typeof/./&&(p.isFunction=function(e){return"function"==typeof e||!1}),p.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},p.isNaN=function(e){return p.isNumber(e)&&e!==+e},p.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===f.call(e)},p.isNull=function(e){return null===e},p.isUndefined=function(e){return void 0===e},p.has=function(e,t){return null!=e&&d.call(e,t)},p.noConflict=function(){return e._=t,this},p.identity=function(e){return e},p.constant=function(e){return function(){return e}},p.noop=function(){},p.property=function(e){return function(t){return t[e]}},p.matches=function(e){var t=p.pairs(e),n=t.length;return function(e){if(null==e)return!n;e=new Object(e);for(var a=0;n>a;a++){var r=t[a],i=r[0];if(r[1]!==e[i]||!(i in e))return!1}return!0}},p.times=function(e,t,n){var a=Array(Math.max(0,e));t=b(t,n,1);for(var r=0;e>r;r++)a[r]=t(r);return a},p.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},p.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},x=p.invert(w),R=function(e){var t=function(t){return e[t]},n="(?:"+p.keys(e).join("|")+")",a=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,a.test(e)?e.replace(r,t):e}};p.escape=R(w),p.unescape=R(x),p.result=function(e,t){if(null==e)return void 0;var n=e[t];return p.isFunction(n)?e[t]():n};var T=0;p.uniqueId=function(e){var t=++T+"";return e?e+t:t},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var _=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\u2028|\u2029/g,k=function(e){return"\\"+H[e]};p.template=function(e,t,n){!t&&n&&(t=n),t=p.defaults({},t,p.templateSettings);var a=RegExp([(t.escape||_).source,(t.interpolate||_).source,(t.evaluate||_).source].join("|")+"|$","g"),r=0,i="__p+='";e.replace(a,function(t,n,a,o,c){return i+=e.slice(r,c).replace(M,k),r=c+t.length,n?i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":a?i+="'+\n((__t=("+a+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(c){throw c.source=i,c}var s=function(e){return o.call(this,e,p)},f=t.variable||"obj";return s.source="function("+f+"){\n"+i+"}",s},p.chain=function(e){var t=p(e);return t._chain=!0,t};var O=function(e){return this._chain?p(e).chain():e};p.mixin=function(e){p.each(p.functions(e),function(t){var n=p[t]=e[t];p.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),O.call(this,n.apply(p,e))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];p.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],O.call(this,n)}}),p.each(["concat","join","slice"],function(e){var t=a[e];p.prototype[e]=function(){return O.call(this,t.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},"function"==typeof n&&n.amd&&n("underscore",[],function(){return p})}.call(this),n("charts/particles",["underscore","components/legends","utils/utils","utils/datasets","utils/colorbrewer"],function(e,t,n,a,r){function i(e,t){this.options={name:"Particle",color:r.Reds[3],size:.3,has_legend:!0,fill_by:null,fill_by_range:null},arguments.length>1&&n.merge(this.options,t),this.data=e}return i.prototype.generateMesh=function(t){for(var n=new a.Array(this.data).raw,r=[],i=0;i<n.x.length;i++){var o=new THREE.Mesh(new THREE.SphereGeometry(this.options.size));o.position.set(t.x(n.x[i]),t.y(n.y[i]),t.z(n.z[i])),r.push(o)}if(this.options.fill_by){var c,s=n[this.options.fill_by];c=e.isNull(this.options.fill_by_range)?e.map(["min","max"],function(t){return e[t](s)}):this.options.fill_by_range;var f=e.range(c[0],c[1]+1,(c[1]-c[0])/this.options.color.length),d=d3.scale.linear().domain(f).range(this.options.color);this.mesh=e.map(r,e.bind(function(e,t){var n=d(s[t]);return e.material=new THREE.MeshBasicMaterial({transparent:!0,color:n}),e},this))}else{var u=e.isArray(this.options.color)?this.options.color.shift():this.options.color,h=new THREE.MeshBasicMaterial({transparent:!0,color:u});e.each(r,function(e){e.material=h}),this.mesh=r}},i.prototype.getDataRanges=function(){var e=new a.Array(this.data);return e.getRanges()},i.prototype.hasLegend=function(){return this.options.has_legend},i.prototype.disappear=function(){e.each(this.mesh,function(e){e.material.opacity=0,e.material.needsUpdate=!0})},i.prototype.appear=function(){e.each(this.mesh,function(e){e.material.opacity=1})},i.prototype.getLegend=function(){return t.generateDiscreteLegend(this.options.name,this.options.color,this)},i.prototype.getMesh=function(){return this.mesh},i}),n("charts/line",["components/legends","utils/utils","utils/range","utils/datasets","utils/colorbrewer"],function(e,t,n,a,r){function i(e,n){this.options={name:"Line",colors:r.Blues[3],thickness:1,has_legend:!0},arguments.length>1&&t.merge(this.options,n),this.data=e,this.dataset=new a.Array(e),this.ranges=this.dataset.getRanges()}return i.prototype.generateMesh=function(e){for(var t=new a.Array(this.data).raw,r=new THREE.Geometry,i=new n(t.x.length,0),o=d3.scale.linear().domain(i.divide(this.options.colors.length)).range(this.options.colors),c=0;c<t.x.length;c++)r.vertices.push(new THREE.Vector3(e.x(t.x[c]),e.y(t.y[c]),e.z(t.z[c]))),r.colors.push(new THREE.Color(o(c)));r.colorsNeedUpdate=!0;var s=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,linewidth:this.options.thickness,transparent:!0});this.mesh=new THREE.Line(r,s)},i.prototype.getDataRanges=function(){return this.ranges},i.prototype.hasLegend=function(){return this.options.has_legend},i.prototype.disappear=function(){this.mesh.material.opacity=0,this.mesh.material.needsUpdate=!0},i.prototype.appear=function(){this.mesh.material.opacity=1},i.prototype.getLegend=function(){return e.generateDiscreteLegend(this.options.name,this.options.colors[0],this)},i.prototype.getMesh=function(){return this.mesh},i}),n("charts/scatter",["components/legends","utils/utils","utils/datasets","utils/colorbrewer"],function(e,t,n,a){function r(e,r){this.options={name:"Scatter",shape:"circle",size:1.5,stroke_width:3,stroke_color:"#000000",fill_color:a.Reds[3][1],has_legend:!0},arguments.length>1&&t.merge(this.options,r),this.dataset=new n.Array(e),this.ranges=this.dataset.getRanges()}return r.prototype.generateMesh=function(e){var t={circle:function(e){e.arc(50,50,40,0,2*Math.PI,!1)},rect:function(e){e.beginPath(),e.moveTo(20,20),e.lineTo(80,20),e.lineTo(80,80),e.lineTo(20,80),e.lineTo(20,20)},cross:function(e){var t=[[35,5],[65,5],[65,35],[95,35],[95,65],[65,65],[65,95],[35,95],[35,65],[5,65],[5,35],[35,35]];e.moveTo(t[11][0],t[11][1]);for(var n=0;n<t.length;n++)e.lineTo(t[n][0],t[n][1])},diamond:function(e){e.moveTo(50,5),e.lineTo(85,50),e.lineTo(50,95),e.lineTo(15,50),e.lineTo(50,5)}},n=document.createElement("canvas");n.width=100,n.height=100;var a=n.getContext("2d");a.fillStyle=this.options.fill_color,t[this.options.shape](a),a.fill(),a.lineWidth=this.options.stroke_width,a.strokeStyle=this.options.stroke_color,a.stroke();var r=new THREE.Texture(n);r.flipY=!1,r.needsUpdate=!0;for(var i=new THREE.SpriteMaterial({map:r,size:10,transparent:!0}),o=this.dataset.raw,c=[],s=0;s<o.x.length;s++){var f=new THREE.Sprite(i);f.position.set(e.x(o.x[s]),e.y(o.y[s]),e.z(o.z[s]));var d=this.options.size;f.scale.set(d,d,d),c.push(f)}this.mesh=c},r.prototype.getDataRanges=function(){return this.ranges},r.prototype.hasLegend=function(){return this.options.has_legend},r.prototype.disappear=function(){for(var e=0;e<this.mesh.length;e++)this.mesh[e].material.opacity=0},r.prototype.appear=function(){for(var e=0;e<this.mesh.length;e++)this.mesh[e].material.opacity=1},r.prototype.getLegend=function(){return e.generateDiscreteLegend(this.options.name,this.options.fill_color,this)},r.prototype.getMesh=function(){return this.mesh},r}),n("charts/cylinder",["components/legends","utils/utils","utils/datasets","utils/colorbrewer"],function(e,t,n){function a(e,a){this.options={name:"Cylinder",color:"#756bb1",size:.3,has_legend:!0},arguments.length>1&&t.merge(this.options,a),this.data=e,this.dataset=new n.Array(e),this.ranges=this.dataset.getRanges()}return a.prototype.generateMesh=function(e){for(var t=new n.Array(this.data).raw,a=new THREE.Geometry,r=0;r<t.x.length;r++){var i=Math.abs(e.x(t.height[r])-e.x(0)),o=Math.abs(e.x(t.radius[r])-e.x(0)),c=new THREE.Mesh(new THREE.CylinderGeometry(o,o,i,16));c.position.set(e.x(t.x[r]),e.y(t.y[r]),e.z(t.z[r])),c.useQuaternion=!0;var s=new THREE.Vector3(t.x_rad[r],t.y_rad[r],t.z_rad[r]).normalize(),f=t.angle[r],d=new THREE.Quaternion;d.setFromAxisAngle(s,f),c.rotation.setFromQuaternion(d),THREE.GeometryUtils.merge(a,c)}var u=new THREE.MeshLambertMaterial({transparent:!0,color:this.options.color});this.mesh=new THREE.Mesh(a,u)},a.prototype.getDataRanges=function(){return this.ranges},a.prototype.hasLegend=function(){return this.options.has_legend},a.prototype.disappear=function(){this.mesh.material.opacity=0,this.mesh.material.needsUpdate=!0},a.prototype.appear=function(){this.mesh.material.opacity=1},a.prototype.getLegend=function(){return e.generateDiscreteLegend(this.options.name,this.options.color,this)},a.prototype.getMesh=function(){return this.mesh},a}),n("charts/debug_object",["components/legends","utils/utils","utils/datasets","utils/colorbrewer"],function(e,t,n){function a(e,a){this.options={name:"objects",color:"#000",has_legend:!0,rotate:!1},arguments.length>1&&t.merge(this.options,a),this.data=e,this.dataset=new n.Array(e),this.ranges=this.dataset.getRanges()}return a.prototype.generateMesh=function(e){for(var a=new n.Array(this.data).raw,r=new THREE.Geometry,i=0;i<a.x.length;i++){var o,c;switch(a.type[i]){case"box":c=t.merge({width:1,height:1,depth:1,widthSegments:1,heightSegments:1,depthSegments:1},a.options[i]),o=new THREE.BoxGeometry(Math.abs(e.x(c.width)-e.x(0)),Math.abs(e.y(c.height)-e.y(0)),Math.abs(e.z(c.depth)-e.z(0)),c.widthSegments,c.heightSegments,c.depthSegments);break;case"cylinder":c=t.merge({radius:1,height:100,radiusSegments:8,heightSegments:1},a.options[i]),o=new THREE.CylinderGeometry(Math.abs(e.x(c.radius)-e.x(0)),Math.abs(e.x(c.radius)-e.x(0)),Math.abs(e.y(c.height)-e.y(0)),c.radiusSegments,c.heightSegments);break;case"sphere":c=t.merge({radius:1,horizontalSegments:8,verticalSegments:6},a.options[i]),o=new THREE.SphereGeometry(Math.abs(e.x(c.radius)-e.x(0)),c.horizontalSegments,c.verticalSegments);break;case"plane":c=t.merge({width:1,height:1,widthSegments:1,heightSegments:1},a.options[i]),o=new THREE.PlaneGeometry(Math.abs(e.x(c.width)-e.x(0)),Math.abs(e.y(c.height)-e.y(0)),c.widthSegments,c.heightSegments)}var s=new THREE.Mesh(o);if(s.position=new THREE.Vector3(e.x(a.x[i]),e.y(a.y[i]),e.z(a.z[i])),0!=this.options.rotate){s.useQuaternion=!0;var f=new THREE.Vector3(a.x_rad[i],a.y_rad[i],a.z_rad[i]).normalize(),d=a.angle[i],u=new THREE.Quaternion;u.setFromAxisAngle(f,d),s.rotation.setFromQuaternion(u)}THREE.GeometryUtils.merge(r,s)}var h=new THREE.MeshPhongMaterial({color:this.options.color,wireframe:!0});this.mesh=new THREE.Mesh(r,h)},a.prototype.getDataRanges=function(){return this.ranges},a.prototype.hasLegend=function(){return this.options.has_legend},a.prototype.disappear=function(){this.mesh.material.opacity=0,this.mesh.material.needsUpdate=!0},a.prototype.appear=function(){this.mesh.material.opacity=1},a.prototype.getLegend=function(){return e.generateDiscreteLegend(this.options.name,this.options.color,this)},a.prototype.getMesh=function(){return this.mesh},a}),n("quick/base",[],function(){return Base=function(){options={},this.options={},this.width=function(e){return this.options.width=e,options=this.options,this},this.height=function(e){return this.options.height=e,options=this.options,this},this.bg_color=function(e){return this.options.bg_color=e,options=this.options,this},this.legend=function(e){return this.options.legend=e,options=this.options,this}}}),n("quick/surface_plot",["components/stage","quick/base","charts/surface","utils/utils"],function(e,t,n,a){function r(t){t.each(function(t){var a=new e(this);a.add(new n(t,options)),a.render()})}return r.fill_colors=function(e){return this.options.fill_colors=e,options=this.options,this},r.has_legend=function(e){return this.options.has_legend=e,options=this.options,this},a.mixin(r,t),r}),n("quick/wireframe_plot",["components/stage","quick/base","charts/wireframe","utils/utils"],function(e,t,n,a){function r(t){t.each(function(t){var a=new e(this);a.add(new n(t,options)),a.render()})}return r.data_name=function(e){return this.options.name=e,options=this.options,this},r.color=function(e){return this.options.color=e,options=this.options,this},r.thickness=function(e){return this.options.thickness=e,options=this.options,this},r.has_legend=function(e){return this.options.has_legend=e,options=this.options,this},a.mixin(r,t),r}),n("quick/particles_plot",["components/stage","quick/base","charts/particles","utils/utils"],function(e,t,n,a){function r(t){t.each(function(t){var a=new e(this);a.add(new n(t,options)),a.render()})}return r.color=function(e){return this.options.color=e,options=this.options,this},r.size=function(e){return this.options.size=e,options=this.options,this},r.has_legend=function(e){return this.options.has_legend=e,options=this.options,this},a.mixin(r,t),r}),n("quick/line_plot",["components/stage","quick/base","charts/line","utils/utils"],function(e,t,n,a){function r(t){t.each(function(t){var a=new e(this);a.add(new n(t,options)),a.render()})}return r.data_name=function(e){this.options.name=e;this.options;return this},r.colors=function(e){this.options.colors=e;this.options;return this},r.thickness=function(e){this.options.thickness=e;this.options;return this},r.has_legend=function(e){this.options.has_legend=e;this.options;return this},a.mixin(r,t),r}),n("quick/scatter_plot",["components/stage","quick/base","charts/scatter","utils/utils"],function(e,t,n,a){function r(t){t.each(function(t){var a=new e(this);a.add(new n(t,options)),a.render()})}return r.data_name=function(e){return this.options.name=e,options=this.options,this},r.shape=function(e){return this.options.shape=e,options=this.options,this},r.size=function(e){return this.options.size=e,options=this.options,this},r.stroke_width=function(e){return this.options.stroke_width=e,options=this.options,this},r.stroke_color=function(e){return this.options.stroke_color=e,options=this.options,this},r.fill_color=function(e){return this.options.fill_color=e,options=this.options,this},r.has_legend=function(e){return this.options.has_legend=e,options=this.options,this},a.mixin(r,t),r}),n("embed/embed",["components/stage","charts/surface","charts/wireframe","charts/scatter","charts/particles","charts/line","charts/cylinder","charts/debug_object"],function(e,t,n,a,r,i,o,c){function s(){return this}return s.parse=function(s,f){for(var d=d3.select(s),u=new e(d[0][0],f.options),h=f.plots,l={Surface:t,Wireframe:n,Scatter:a,Particles:r,Line:i,Cylinder:o,DebugObject:c},p=0;p<h.length;p++){var b=new l[h[p].type](h[p].data,h[p].options);u.add(b)}return u},s}),n("embed/nyaplot",["components/stage","charts/surface","charts/wireframe","charts/scatter","charts/particles","charts/line"],function(e,t,n,a,r,i){function o(t,n){this.uuid=Nyaplot.uuid.v4(),this.stage=new e(t[0][0],n),this.rendered=!1}function c(e,t){var n=Nyaplot.Manager.getData(e),a=Nyaplot.uuid.v4(),r=n.columnWithFilters(a,t.x),i=n.columnWithFilters(a,t.y),o=n.columnWithFilters(a,t.z);return{x:r,y:i,z:o}}function s(e,t){var n=c(e,t);return{x:n.x,y:n.y,z:n.z}}function f(e,t){var n={},a=c(e,t);return["x","y"].forEach(function(e){var t=a[e],r=t.filter(function(e,n){return t.indexOf(e)==n}),i=r.map(function(e){for(var n=t.indexOf(e),a=n;t[a]==e;)a++;return a-n});if(i.every(function(e){return e==i[0]&&1!=e})){var o=i[0],c=function(e,t){for(var n=[],a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n};return n.x=c(a.x,o),n.y=c(a.y,o),void(n.z=c(a.z,o))}}),n}var d={surface:{chart:t,dtype:"Matrix"},wireframe:{chart:n,dtype:"Matrix"},scatter:{chart:a,dtype:"Array"},particles:{chart:r,dtype:"Array"},line:{chart:i,dtype:"Array"}};return o.prototype.addDiagram=function(e,t,n){var a={Matrix:f,Array:s}[d[e].dtype](t,n),r=new d[e].chart(a,n);this.stage.add(r)},o.prototype.addFilter=function(){},o.prototype.update=function(){this.rendered||(this.stage.render(),this.rendered=!0)},{pane:o}}),n("main",["require","exports","module","components/stage","charts/surface","charts/wireframe","charts/particles","charts/line","charts/scatter","charts/cylinder","charts/debug_object","quick/surface_plot","quick/wireframe_plot","quick/particles_plot","quick/line_plot","quick/scatter_plot","utils/database","embed/embed","embed/nyaplot"],function(e){var t={};
return t.Stage=e("components/stage"),t.Surface=e("charts/surface"),t.Wireframe=e("charts/wireframe"),t.Particles=e("charts/particles"),t.Line=e("charts/line"),t.Scatter=e("charts/scatter"),t.Cylinder=e("charts/cylinder"),t.DebugObject=e("charts/debug_object"),t.SurfacePlot=e("quick/surface_plot"),t.WireframePlot=e("quick/wireframe_plot"),t.ParticlesPlot=e("quick/particles_plot"),t.LinePlot=e("quick/line_plot"),t.ScatterPlot=e("quick/scatter_plot"),t.DataBase=e("utils/database"),t.Embed=e("embed/embed"),t.Nya=e("embed/nyaplot"),t}),t("main")});